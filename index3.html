<!DOCTYPE html>
<html lang="fr">
    <head>
        <link rel="stylesheet" type="text/css" href="style.css">
        <script src="https://d3js.org/d3.v4.min.js"></script>
        <script src="./js/RadarChart.js"></script>

        <style>
            body {
                overflow: hidden;
                margin: 0;
                font-size: 14px;
                font-family: "Helvetica Neue", Helvetica;
            }
            #result {
                position: absolute;
                top: 50px;
                left: 100px;
            }
        </style>
    </head>

    <body>
            <div style="margin-left: 5px; margin-top:5px;">
                <a href="index.html">Index</a>
                <a href="index2.html">Histogram</a>
            </div>
    <div id="body">
        <div id="graph"></div>

    </div>
    </body>

    <script>
        const datasetFIFA = "./datasets/fifa.json";

        document.addEventListener("DOMContentLoaded", () => {
            d3.json(datasetFIFA, function (dataFifa) {
                console.log("[START]");
                const dataViz = new DataViz("#graph", dataFifa, 600, 600);
                dataViz.draw();
            })
        });

        class DataViz {
            constructor(id, datasetFifa, width, height) {
                this.datasetFifa = datasetFifa;
                this.id = id;
                this.width = width;
                this.height = height;
                this.svg = d3.select(id).attr("width", this.width).attr("height", this.height);
                this.listFiveFirst = [];
                this.listFive = [];
            }

            draw() {
                var obj1;var obj2;var obj3;var obj4;var obj5;var obj6;

                for (var i = 0; i < this.datasetFifa.length; i++) {
                    this.listFiveFirst.push(this.datasetFifa[i].Name);
                    obj1 = {"axe": "Acceleration", "value": this.datasetFifa[i].Acceleration /100};
                    obj2 = {"axe": "Aggression", "value": this.datasetFifa[i].Aggression/100};
                    obj3 = {"axe": "Agility", "value": this.datasetFifa[i].Agility/100};
                    obj4 = {"axe": "Balance", "value": this.datasetFifa[i].Balance/100};
                    obj5 = {"axe": "Crossing", "value": this.datasetFifa[i].Crossing/100};
                    obj6 = {"axe": "Dribbling", "value": this.datasetFifa[i].Dribbling/100};
                    /*var object = this.datasetFifa[i];
                    for (var obj in object) {
                        this.tabData.push(obj);
                    }*/
                    this.listFive.push(new Array(obj1, obj2, obj3, obj4, obj5, obj6));
                }
                //this.listFive.push(myObjects);

                RadarChart.draw(this.id, this.listFive, {
                    w: this.width,
                    y: this.height,
                    maxValue: 0.1,
                    levels: 6,
                    ExtraWidthX: 300
                });

                console.log("[TAILLE data FIFA] "+JSON.stringify(this.listFive, null, 2));


////////////////////////////////////////////
/////////// Initiate legend ////////////////
////////////////////////////////////////////

                var colorScale = d3.scaleOrdinal(d3.schemeCategory10);

                var svg = d3.select('#body')
                    .selectAll('svg')
                    .append('svg')
                    .attr("width", this.width+300)
                    .attr("height", this.height)

//Create the title for the legend
                var text = svg.append("text")
                    .attr("class", "title")
                    .attr('transform', 'translate(90,0)')
                    .attr("x", this.width - 70)
                    .attr("y", 10)
                    .attr("font-size", "12px")
                    .attr("fill", "#404040")
                    .text("Nom des Joueurs");

//Initiate Legend
                var legend = svg.append("g")
                    .attr("class", "legend")
                    .attr("height", 100)
                    .attr("width", 200)
                    .attr('transform', 'translate(90,20)')
                ;
                //Create colour squares
                legend.selectAll('rect')
                    .data(this.listFiveFirst)
                    .enter()
                    .append("rect")
                    .attr("x", this.width - 65)
                    .attr("y", function(d, i){ return i * 20;})
                    .attr("width", 10)
                    .attr("height", 10)
                    .style("fill", function(d, i){ return colorScale(i);})
                ;
                //Create text next to squares
                legend.selectAll('text')
                    .data(this.listFiveFirst)
                    .enter()
                    .append("text")
                    .attr("x", this.width - 52)
                    .attr("y", function(d, i){ return i * 20 + 9;})
                    .attr("font-size", "11px")
                    .attr("fill", "#737373")
                    .text(function(d) { return d; })
                ;


            }
        }

    </script>
</html>